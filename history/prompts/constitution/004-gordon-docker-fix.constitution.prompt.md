---
ID: "004"
TITLE: "Gordon Docker Infrastructure Constitution Fix"
STAGE: "constitution"
DATE_ISO: "2026-02-01"
SURFACE: "agent"
MODEL: "claude-sonnet-4-5-20250929"
FEATURE: "gordon-docker-infra"
BRANCH: "006-gordon-docker-infra"
USER: "User"
COMMAND: "Create specification for correcting Phase IV constitutional violation regarding Docker infrastructure generation. The system MUST use Gordon AI for all Dockerfile generation, with no manual authoring."
LABELS: ["constitution", "phase-4", "gordon", "docker", "violation-fix"]
LINKS:
  SPEC: "specs/006-gordon-docker-infra/spec.md"
  TICKET: "null"
  ADR: "null"
  PR: "null"
FILES_YAML:
  - specs/006-gordon-docker-infra/spec.md (created)
  - specs/006-gordon-docker-infra/checklists/requirements.md (created)
TESTS_YAML:
  - Constitution compliance verification (FR-001 to FR-005)
  - Dockerfile generation validation (FR-006 to FR-010)
  - Security scanning verification (FR-011 to FR-013)
  - Build and deployment tests (FR-014 to FR-016)
PROMPT_TEXT: |
  User identified a constitutional violation in Phase IV: Current implementation uses manually written Dockerfiles, which violates Constitution Line 94 requirement that "AI tools (kubectl-ai, kagent, Gordon) MUST be used for all infrastructure generation. NO manual YAML/Dockerfile authoring is permitted."

  User requested following the Agentic Dev Stack workflow strictly:
  /sp.constitution → /sp.specify → /sp.plan → /sp.tasks → /sp.implement

  Constraints:
  - Phase III business logic must remain untouched
  - Only infrastructure and deployment layer can change
  - Ollama must remain the LLM runtime
  - Use Gordon AI for all Dockerfile generation
  - DO NOT write manual Dockerfiles

  Additional note: "sath ma chat bot ko b thek krna working kre task generate todo operation" (Also fix the chatbot to make it work for task generation and todo operations)

  Executed /sp.specify skill to create the specification.
RESPONSE_TEXT: |
  Created comprehensive specification for correcting Phase IV constitutional violation:

  1. **Feature Branch**: 006-gordon-docker-infra created
  2. **Specification**: specs/006-gordon-docker-infra/spec.md with:
     - 3 prioritized user stories (P1: Constitution compliance, P2: Multi-stage builds, P3: Security scanning)
     - 19 functional requirements (FR-001 to FR-019)
     - 8 measurable success criteria (SC-001 to SC-008)
     - Clear edge cases and assumptions

  3. **Quality Checklist**: specs/006-gordon-docker-infra/checklists/requirements.md
     - All validation items PASS
     - Specification ready for /sp.plan phase

  4. **Key Requirements**:
     - FR-001: All Dockerfiles MUST be generated by Gordon AI tool
     - FR-003: Manual editing of Gordon-generated Dockerfiles is PROHIBITED
     - FR-006: Gordon MUST generate multi-stage Dockerfiles
     - FR-011: Gordon MUST scan images for CVEs
     - SC-001: Zero manually authored Dockerfiles remain
     - SC-002: Image size reduced by 40%

  5. **Additional Note**: Chatbot fix for task generation will be included in tasks phase.

  Specification complete and approved. Ready for /sp.plan to create architecture plan.
OUTCOME: "success"
EVALUATION: "Specification created successfully following constitution requirements. All checklist items pass. User stories prioritize constitution compliance (P1), optimization (P2), and security (P3). Chatbot fix noted for tasks phase. Ready to proceed to planning."
---
