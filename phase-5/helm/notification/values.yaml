# Notification Microservice Helm Chart - Phase 5
# Default values for notification service deployment

replicaCount: 1

image:
  repository: YOUR_REGISTRY/notification
  pullPolicy: IfNotPresent
  tag: "latest"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

service:
  type: ClusterIP
  port: 4000
  annotations: {}

resources:
  requests:
    memory: "128Mi"
    cpu: "100m"
  limits:
    memory: "256Mi"
    cpu: "250m"

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Dapr configuration
dapr:
  enabled: true
  appId: "notification-service"
  appPort: 4000
  enableAppHealthCheck: true

# Environment variables
env:
  # Application settings
  APP_NAME: "notification-service"
  APP_VERSION: "1.0.0"
  LOG_LEVEL: "INFO"
  DAPR_HTTP_PORT: "3500"

  # Email configuration (from secrets)
  EMAIL_API_KEY:
    secretRef:
      name: email-credentials
      key: api-key
  FROM_EMAIL:
    secretRef:
      name: email-credentials
      key: from-email

# Health checks
healthChecks:
  liveness:
    path: /health
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3
  readiness:
    path: /ready
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3

# ConfigMap settings
configMap:
  create: true
  data:
    # Application configuration
    APP_NAME: "notification-service"
    APP_VERSION: "1.0.0"
    LOG_LEVEL: "INFO"
    DAPR_HTTP_PORT: "3500"

# Secret settings
secrets:
  email:
    # Email API credentials
    apiKey: "your-email-api-key-here"
    fromEmail: "noreply@todoapp.com"

# Kafka / Dapr component configuration
kafka:
  brokers:
    - "my-cluster-kafka-bootstrap.kafka:9092"
  consumerGroup: "notification-service-group"
  autoCommit: "true"

# Email service configuration
email:
  provider: "sendgrid"  # sendgrid, ses, mock
  mockMode: true  # Set to false to use real email service
  fromName: "Todo App"
